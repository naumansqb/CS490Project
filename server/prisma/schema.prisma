generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model UserProfile {
  userId                      String                        @id @map("user_id")
  firstName                   String?                       @map("first_name") @db.VarChar(100)
  lastName                    String?                       @map("last_name") @db.VarChar(100)
  preferredName               String?                       @map("preferred_name") @db.VarChar(100)
  email                       String?                       @db.VarChar(255)
  phone_number                String?                       @db.VarChar(20)
  headline                    String?                       @db.VarChar(255)
  bio                         String?
  profilePhotoUrl             String?                       @map("profile_photo_url") @db.VarChar(500)
  industry                    String?                       @db.VarChar(100)
  locationCity                String?                       @map("location_city") @db.VarChar(100)
  locationState               String?                       @map("location_state") @db.VarChar(100)
  locationCountry             String?                       @map("location_country") @db.VarChar(100)
  willingToRelocate           Boolean?                      @default(false) @map("willing_to_relocate")
  linkedinUrl                 String?                       @map("linkedin_url") @db.VarChar(255)
  githubUrl                   String?                       @map("github_url") @db.VarChar(255)
  portfolioUrl                String?                       @map("portfolio_url") @db.VarChar(255)
  websiteUrl                  String?                       @map("website_url") @db.VarChar(255)
  yearsOfExperience           Decimal?                      @map("years_of_experience") @db.Decimal(4, 1)
  careerLevel                 String?                       @map("career_level") @db.VarChar(50)
  desiredSalaryMin            Decimal?                      @map("desired_salary_min") @db.Decimal(12, 2)
  desiredSalaryMax            Decimal?                      @map("desired_salary_max") @db.Decimal(12, 2)
  salaryCurrency              String?                       @default("USD") @map("salary_currency") @db.VarChar(10)
  openToOpportunities         Boolean?                      @default(true) @map("open_to_opportunities")
  jobSearchStatus             String?                       @map("job_search_status") @db.VarChar(50)
  preferredWorkType           String?                       @map("preferred_work_type") @db.VarChar(50)
  profileCompleteness         Int?                          @default(0) @map("profile_completeness")
  profileVisibility           String?                       @default("private") @map("profile_visibility") @db.VarChar(50)
  createdAt                   DateTime?                     @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt                   DateTime?                     @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  certifications              Certification[]
  companyFollows              CompanyFollows[]
  education                   Education[]
  job_match_analysis          job_match_analysis[]
  job_match_preferences       job_match_preferences?
  jobOpportunities            JobOpportunity[]
  skills                      Skill[]
  skills_gap_analysis         skills_gap_analysis[]
  skills_gap_analysis_history skills_gap_analysis_history[]
  specialProjects             SpecialProject[]
  workExperiences             WorkExperience[]
  professionalContacts        ProfessionalContact[]
  referralRequests            ReferralRequest[]
  ownedTeams                  Team[]                        @relation("TeamOwner")
  teamMemberships             TeamMember[]
  sentInvitations             TeamInvitation[]              @relation("InvitationSender")
  sharedJobs                  SharedJobOpportunity[]
  jobComments                 JobComment[]
  assignedTasks               TeamTask[]                    @relation("TaskAssignee")
  createdTasks                TeamTask[]                    @relation("TaskCreator")
  teamActivities              TeamActivity[]
  feedbackReceived            TeamFeedback[]                @relation("FeedbackMentee")
  feedbackGiven               TeamFeedback[]                @relation("FeedbackMentor")

  @@index([userId], map: "idx_user_profiles_user_id")
  @@map("user_profiles")
}

model WorkExperience {
  id              String      @id @default(dbgenerated("uuid_generate_v4()"))
  userId          String      @map("user_id")
  companyName     String      @map("company_name") @db.VarChar(255)
  positionTitle   String      @map("position_title") @db.VarChar(255)
  employmentType  String?     @map("employment_type") @db.VarChar(50)
  locationCity    String?     @map("location_city") @db.VarChar(100)
  locationState   String?     @map("location_state") @db.VarChar(100)
  locationCountry String?     @map("location_country") @db.VarChar(100)
  isRemote        Boolean?    @default(false) @map("is_remote")
  startDate       DateTime    @map("start_date") @db.Date
  endDate         DateTime?   @map("end_date") @db.Date
  isCurrent       Boolean?    @default(false) @map("is_current")
  description     String?
  displayOrder    Int?        @default(0) @map("display_order")
  createdAt       DateTime?   @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt       DateTime?   @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  userProfile     UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([startDate, endDate], map: "idx_work_exp_dates")
  @@index([userId, displayOrder], map: "idx_work_exp_display_order")
  @@index([userId], map: "idx_work_exp_user_id")
  @@map("work_experiences")
}

model Education {
  id              String      @id @default(dbgenerated("uuid_generate_v4()"))
  userId          String      @map("user_id")
  institutionName String      @map("institution_name") @db.VarChar(255)
  degreeType      String?     @map("degree_type") @db.VarChar(100)
  major           String?     @db.VarChar(255)
  minor           String?     @db.VarChar(255)
  gpa             Decimal?    @db.Decimal(3, 2)
  gpaScale        Decimal?    @default(4.00) @map("gpa_scale") @db.Decimal(3, 2)
  showGpa         Boolean?    @default(false) @map("show_gpa")
  startDate       DateTime?   @map("start_date") @db.Date
  endDate         DateTime?   @map("end_date") @db.Date
  isCurrent       Boolean?    @default(false) @map("is_current")
  graduationDate  DateTime?   @map("graduation_date") @db.Date
  locationCity    String?     @map("location_city") @db.VarChar(100)
  locationState   String?     @map("location_state") @db.VarChar(100)
  locationCountry String?     @map("location_country") @db.VarChar(100)
  honors          String[]
  activities      String[]
  description     String?
  displayOrder    Int?        @default(0) @map("display_order")
  createdAt       DateTime?   @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt       DateTime?   @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  userProfile     UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([startDate, endDate], map: "idx_education_dates")
  @@index([degreeType], map: "idx_education_degree_type")
  @@index([userId], map: "idx_education_user_id")
  @@map("education")
}

model Skill {
  id                String      @id @default(dbgenerated("uuid_generate_v4()"))
  userId            String      @map("user_id")
  skillName         String      @map("skill_name") @db.VarChar(100)
  skillCategory     String?     @map("skill_category") @db.VarChar(100)
  proficiencyLevel  String?     @map("proficiency_level") @db.VarChar(50)
  yearsOfExperience Decimal?    @map("years_of_experience") @db.Decimal(4, 1)
  displayOrder      Int?        @default(0) @map("display_order")
  createdAt         DateTime?   @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt         DateTime?   @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  userProfile       UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@unique([userId, skillName])
  @@index([skillCategory], map: "idx_skills_category")
  @@index([skillName], map: "idx_skills_name")
  @@index([proficiencyLevel], map: "idx_skills_proficiency")
  @@index([userId], map: "idx_skills_user_id")
  @@map("skills")
}

model Certification {
  id                  String      @id @default(dbgenerated("uuid_generate_v4()"))
  userId              String      @map("user_id")
  name                String      @db.VarChar(255)
  issuingOrganization String      @map("issuing_organization") @db.VarChar(255)
  issueDate           DateTime    @map("issue_date") @db.Date
  expirationDate      DateTime?   @map("expiration_date") @db.Date
  doesNotExpire       Boolean?    @default(false) @map("does_not_expire")
  displayOrder        Int?        @default(0) @map("display_order")
  createdAt           DateTime?   @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt           DateTime?   @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  userProfile         UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([expirationDate], map: "idx_certifications_expiration")
  @@index([userId], map: "idx_certifications_user_id")
  @@map("certifications")
}

model SpecialProject {
  id                 String      @id @default(dbgenerated("uuid_generate_v4()"))
  userId             String      @map("user_id")
  projectName        String      @map("project_name") @db.VarChar(255)
  description        String
  startDate          DateTime?   @map("start_date") @db.Date
  endDate            DateTime?   @map("end_date") @db.Date
  status             String?     @default("completed") @db.VarChar(50)
  projectUrl         String?     @map("project_url") @db.VarChar(500)
  repositoryUrl      String?     @map("repository_url") @db.VarChar(500)
  skillsDemonstrated String[]    @map("skills_demonstrated") @db.VarChar(100)
  displayOrder       Int?        @default(0) @map("display_order")
  createdAt          DateTime?   @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt          DateTime?   @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  userProfile        UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([status], map: "idx_projects_status")
  @@index([userId], map: "idx_projects_user_id")
  @@map("special_projects")
}

model JobOpportunity {
  id                          String                        @id @default(dbgenerated("uuid_generate_v4()"))
  userId                      String                        @map("user_id")
  title                       String                        @db.VarChar(255)
  company                     String                        @db.VarChar(255)
  location                    String?                       @db.VarChar(255)
  salaryMin                   String?                       @map("salary_min") @db.VarChar(50)
  salaryMax                   String?                       @map("salary_max") @db.VarChar(50)
  postingUrl                  String?                       @map("posting_url")
  deadline                    DateTime?                     @db.Date
  description                 String?
  industry                    String                        @db.VarChar(100)
  jobType                     String                        @map("job_type") @db.VarChar(50)
  personalNotes               String?                       @map("personal_notes")
  salaryNegotiationNotes      String?                       @map("salary_negotiation_notes")
  interviewNotes              String?                       @map("interview_notes")
  createdAt                   DateTime?                     @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt                   DateTime?                     @default(now()) @map("updated_at") @db.Timestamp(6)
  currentStatus               application_status?           @default(interested) @map("current_status")
  companyId                   String?                       @map("company_id") @db.Uuid
  applicationHistory          ApplicationHistory[]
  cover_letters               cover_letters[]
  interview_insights          interview_insights?
  interviews                  interviews[]
  jobContacts                 JobContact[]
  job_match_analysis          job_match_analysis[]
  companyRef                  Company?                      @relation(fields: [companyId], references: [id], onUpdate: NoAction)
  user_profiles               UserProfile                   @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  skills_gap_analysis         skills_gap_analysis[]
  skills_gap_analysis_history skills_gap_analysis_history[]
  referralRequests            ReferralRequest[]
  sharedWith                  SharedJobOpportunity[]
  relatedTasks                TeamTask[]

  @@index([createdAt], map: "idx_job_opportunity_created_at")
  @@index([deadline], map: "idx_job_opportunity_deadline")
  @@index([userId], map: "idx_job_opportunity_user_id")
  @@index([companyId], map: "idx_job_opportunities_company_id")
  @@map("job_opportunity")
}

model ResumeTemplate {
  id          String    @id @default(dbgenerated("uuid_generate_v4()"))
  name        String    @unique @db.VarChar(255)
  description String?   @db.VarChar(1000)
  type        String    @db.VarChar(50)
  previewUrl  String?   @map("preview_url") @db.VarChar(500)
  structure   Json
  isDefault   Boolean   @default(false) @map("is_default")
  isActive    Boolean   @default(true) @map("is_active")
  createdAt   DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime? @default(now()) @map("updated_at") @db.Timestamp(6)
  resumes     Resume[]

  @@index([isActive], map: "idx_resume_templates_is_active")
  @@index([isDefault], map: "idx_resume_templates_is_default")
  @@map("resume_templates")
}

model Resume {
  id           String         @id @default(dbgenerated("uuid_generate_v4()"))
  userId       String         @map("user_id")
  name         String         @db.VarChar(255)
  templateId   String         @map("template_id")
  isDefault    Boolean        @default(false) @map("is_default")
  content      Json
  lastModified DateTime?      @default(now()) @map("last_modified") @db.Timestamp(6)
  createdAt    DateTime?      @default(now()) @map("created_at") @db.Timestamp(6)
  template     ResumeTemplate @relation(fields: [templateId], references: [id], onUpdate: NoAction)

  @@index([templateId], map: "idx_resumes_template_id")
  @@index([userId, isDefault], map: "idx_resumes_user_default")
  @@index([userId], map: "idx_resumes_user_id")
  @@map("resumes")
}

model ApplicationHistory {
  id             String             @id @default(dbgenerated("uuid_generate_v4()"))
  jobId          String             @map("job_id")
  status         application_status
  notes          String?
  timestamp      DateTime?          @default(now()) @db.Timestamp(6)
  jobOpportunity JobOpportunity     @relation(fields: [jobId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([jobId], map: "idx_application_history_job_id")
  @@index([timestamp], map: "idx_application_history_timestamp")
  @@map("application_history")
}

model JobContact {
  id             String         @id @default(dbgenerated("uuid_generate_v4()"))
  jobId          String         @map("job_id")
  name           String         @db.VarChar(255)
  role           String?        @db.VarChar(255)
  email          String?        @db.VarChar(255)
  phone          String?        @db.VarChar(50)
  created_at     DateTime?      @default(now()) @db.Timestamp(6)
  jobOpportunity JobOpportunity @relation(fields: [jobId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([jobId], map: "idx_job_contacts_job_id")
  @@map("job_contacts")
}

model cover_letters {
  id              String          @id @default(dbgenerated("uuid_generate_v4()"))
  user_id         String
  job_id          String?
  title           String          @db.VarChar(255)
  content         Json
  tone            String?         @db.VarChar(50)
  culture         String?         @db.VarChar(50)
  created_at      DateTime?       @default(now()) @db.Timestamp(6)
  updated_at      DateTime?       @default(now()) @db.Timestamp(6)
  job_opportunity JobOpportunity? @relation(fields: [job_id], references: [id], onUpdate: NoAction)

  @@index([job_id], map: "idx_cover_letters_job_id")
  @@index([user_id], map: "idx_cover_letters_user_id")
}

model Company {
  id                    String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name                  String           @db.VarChar(255)
  size                  String?          @db.VarChar(50)
  industry              String?          @db.VarChar(100)
  location              String?          @db.VarChar(255)
  website               String?          @db.VarChar(500)
  description           String?
  mission               String?
  logoUrl               String?          @map("logo_url") @db.VarChar(500)
  contactInfo           Json?            @map("contact_info")
  glassdoorRating       Decimal?         @map("glassdoor_rating") @db.Decimal(2, 1)
  createdAt             DateTime?        @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime?        @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  leadership            Json?
  products_and_services Json?
  competitive_landscape String?
  companyFollows        CompanyFollows[]
  company_news          company_news[]
  jobOpportunities      JobOpportunity[]
  professionalContacts  ProfessionalContact[]

  @@index([industry], map: "idx_companies_industry")
  @@index([name], map: "idx_companies_name")
  @@map("companies")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model company_news {
  id              String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  company_id      String    @db.Uuid
  headline        String    @db.VarChar(500)
  summary         String?
  publish_date    DateTime  @db.Date
  category        String    @db.VarChar(50)
  source          String?   @db.VarChar(255)
  url             String?   @db.VarChar(1000)
  relevance_score Int?
  key_points      Json?
  thumbnail_url   String?   @db.VarChar(1000)
  sentiment       String?   @db.VarChar(20)
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  updated_at      DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  companies       Company   @relation(fields: [company_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([category], map: "idx_company_news_category")
  @@index([company_id], map: "idx_company_news_company_id")
  @@index([publish_date], map: "idx_company_news_publish_date")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model interview_insights {
  id                          String         @id @default(dbgenerated("uuid_generate_v4()"))
  job_id                      String         @unique
  company_name                String         @db.VarChar(255)
  job_title                   String         @db.VarChar(255)
  interview_process           Json
  common_questions            Json
  interviewer_information     Json
  company_specific_insights   Json
  preparation_recommendations Json
  research_date               DateTime       @db.Date
  confidence                  String         @db.VarChar(20)
  analysis_date               DateTime?      @default(now()) @db.Timestamp(6)
  created_at                  DateTime?      @default(now()) @db.Timestamp(6)
  updated_at                  DateTime?      @default(now()) @db.Timestamp(6)
  job_opportunity             JobOpportunity @relation(fields: [job_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([company_name], map: "idx_interview_insights_company_name")
  @@index([job_id], map: "idx_interview_insights_job_id")
  @@index([research_date], map: "idx_interview_insights_research_date")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model job_match_analysis {
  id                      String         @id @default(dbgenerated("uuid_generate_v4()"))
  job_id                  String
  user_id                 String
  overall_match_score     Int
  category_scores         Json
  strengths               Json
  gaps                    Json
  improvement_suggestions Json
  matched_skills          Json
  missing_skills          Json
  analysis_date           DateTime?      @default(now()) @db.Timestamp(6)
  created_at              DateTime?      @default(now()) @db.Timestamp(6)
  updated_at              DateTime?      @default(now()) @db.Timestamp(6)
  weights_used            Json?
  job_opportunity         JobOpportunity @relation(fields: [job_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user_profiles           UserProfile    @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([analysis_date], map: "idx_job_match_analysis_date")
  @@index([job_id], map: "idx_job_match_analysis_job_id")
  @@index([user_id], map: "idx_job_match_analysis_user_id")
  @@index([user_id, job_id, analysis_date(sort: Desc)], map: "idx_job_match_analysis_user_job_date")
}

model job_match_preferences {
  user_id             String      @id
  skills_weight       Decimal?    @default(1.00) @db.Decimal(5, 2)
  experience_weight   Decimal?    @default(1.00) @db.Decimal(5, 2)
  education_weight    Decimal?    @default(1.00) @db.Decimal(5, 2)
  requirements_weight Decimal?    @default(1.00) @db.Decimal(5, 2)
  custom_criteria     Json?
  created_at          DateTime?   @default(now()) @db.Timestamp(6)
  updated_at          DateTime?   @default(now()) @db.Timestamp(6)
  user_profile        UserProfile @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model skills_gap_analysis {
  id                        String         @id @default(dbgenerated("uuid_generate_v4()"))
  job_id                    String
  user_id                   String
  matched_skills            Json
  missing_skills            Json
  weak_skills               Json
  learning_resources        Json
  prioritized_learning_path Json
  overall_gap_score         Int
  analysis_date             DateTime?      @default(now()) @db.Timestamp(6)
  created_at                DateTime?      @default(now()) @db.Timestamp(6)
  updated_at                DateTime?      @default(now()) @db.Timestamp(6)
  job_opportunity           JobOpportunity @relation(fields: [job_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user_profiles             UserProfile    @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@unique([job_id, user_id])
  @@index([analysis_date], map: "idx_skills_gap_analysis_date")
  @@index([job_id], map: "idx_skills_gap_analysis_job_id")
  @@index([user_id], map: "idx_skills_gap_analysis_user_id")
}

/// This table stores historical snapshots of skills gap analyses to track progress over time
model skills_gap_analysis_history {
  id                        String         @id @default(dbgenerated("uuid_generate_v4()"))
  job_id                    String
  user_id                   String
  matched_skills            Json           @map("matched_skills")
  missing_skills            Json           @map("missing_skills")
  weak_skills               Json           @map("weak_skills")
  learning_resources        Json           @map("learning_resources")
  prioritized_learning_path Json           @map("prioritized_learning_path")
  overall_gap_score         Int            @map("overall_gap_score")
  snapshot_date             DateTime       @default(now()) @map("snapshot_date") @db.Timestamp(6)
  created_at                DateTime?      @default(now()) @map("created_at") @db.Timestamp(6)
  job_opportunity           JobOpportunity @relation(fields: [job_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user_profiles             UserProfile    @relation(fields: [user_id], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([user_id], map: "idx_skills_gap_history_user_id")
  @@index([job_id], map: "idx_skills_gap_history_job_id")
  @@index([snapshot_date], map: "idx_skills_gap_history_snapshot_date")
  @@index([user_id, job_id, snapshot_date(sort: Desc)], map: "idx_skills_gap_history_user_job_date")
  @@map("skills_gap_analysis_history")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model interviews {
  id               String         @id @default(dbgenerated("uuid_generate_v4()"))
  job_id           String
  scheduled_date   DateTime       @db.Timestamptz(6)
  interview_type   String         @db.VarChar(20)
  duration_minutes Int?           @default(60)
  status           String         @default("scheduled") @db.VarChar(20)
  location         String?
  meeting_link     String?
  phone_number     String?        @db.VarChar(20)
  interviewer_name String?        @db.VarChar(255)
  created_at       DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?      @default(now()) @db.Timestamptz(6)
  job_opportunity  JobOpportunity @relation(fields: [job_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model CompanyFollows {
  id          String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  userId      String      @map("user_id")
  companyId   String      @map("company_id") @db.Uuid
  createdAt   DateTime?   @default(now()) @map("created_at") @db.Timestamp(6)
  company     Company     @relation(fields: [companyId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userProfile UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@unique([userId, companyId])
  @@index([userId], map: "idx_company_follows_user_id")
  @@index([companyId], map: "idx_company_follows_company_id")
  @@index([createdAt], map: "idx_company_follows_created_at")
  @@map("company_follows")
}

model ProfessionalContact {
  id                   String               @id @default(dbgenerated("uuid_generate_v4()"))
  userId               String               @map("user_id")

  firstName            String?              @map("first_name") @db.VarChar(100)
  lastName             String?              @map("last_name") @db.VarChar(100)
  fullName             String               @map("full_name") @db.VarChar(255)
  email                String               @db.VarChar(255)
  phone                String?              @db.VarChar(50)
  linkedinUrl          String?              @map("linkedin_url") @db.VarChar(500)
  websiteUrl           String?              @map("website_url") @db.VarChar(500)
  profilePhotoUrl      String?              @map("profile_photo_url") @db.VarChar(500)
  company              String?              @db.VarChar(255)
  jobTitle             String?              @map("job_title") @db.VarChar(255)
  industry             String?              @db.VarChar(100)
  locationCity         String?              @map("location_city") @db.VarChar(100)
  locationState        String?              @map("location_state") @db.VarChar(100)
  locationCountry      String?              @map("location_country") @db.VarChar(100)
  relationshipType     String?              @map("relationship_type") @db.VarChar(50)
  relationshipStrength Int?                 @default(50) @map("relationship_strength")
  category             String?              @db.VarChar(50)
  tags                 String[]
  personalNotes        String?              @map("personal_notes")
  professionalNotes    String?              @map("professional_notes")
  mutualConnections    String[]             @map("mutual_connections") @db.VarChar(255)
  linkedCompanyId      String?              @map("linked_company_id") @db.Uuid
  linkedJobIds         String[]             @map("linked_job_ids")
  lastContactDate      DateTime?            @map("last_contact_date") @db.Date
  nextFollowUpDate     DateTime?            @map("next_follow_up_date") @db.Date
  followUpFrequency    String?              @map("follow_up_frequency") @db.VarChar(50)
  source               String?              @db.VarChar(50)
  createdAt            DateTime?            @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt            DateTime?            @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  interactions         ContactInteraction[]
  companyRef           Company?             @relation(fields: [linkedCompanyId], references: [id], onUpdate: NoAction)
  userProfile          UserProfile          @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  referralRequests     ReferralRequest[]

  @@index([userId], map: "idx_professional_contacts_user_id")
  @@index([email], map: "idx_professional_contacts_email")
  @@index([company], map: "idx_professional_contacts_company")
  @@index([industry], map: "idx_professional_contacts_industry")
  @@index([relationshipType], map: "idx_professional_contacts_relationship_type")
  @@index([nextFollowUpDate], map: "idx_professional_contacts_follow_up")
  @@index([linkedCompanyId], map: "idx_professional_contacts_company_id")
  @@map("professional_contacts")
}

model ContactInteraction {
  id                 String              @id @default(dbgenerated("uuid_generate_v4()"))
  contactId          String              @map("contact_id")
  interactionType    String              @map("interaction_type") @db.VarChar(50)
  interactionDate    DateTime            @map("interaction_date") @db.Timestamp(6)
  notes              String?
  outcome            String?             @db.VarChar(255)
  relationshipChange Int?                @map("relationship_change")
  createdAt          DateTime?           @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt          DateTime?           @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  contact            ProfessionalContact @relation(fields: [contactId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([contactId], map: "idx_contact_interactions_contact_id")
  @@index([interactionDate], map: "idx_contact_interactions_date")
  @@index([interactionType], map: "idx_contact_interactions_type")
  @@map("contact_interactions")
}

model ReferralRequest {
  id                 String              @id @default(dbgenerated("uuid_generate_v4()"))
  userId             String              @map("user_id")
  jobId              String              @map("job_id")
  contactId          String              @map("contact_id")
  status             referral_status     @default(draft)
  requestMessage     String?             @map("request_message")
  templateUsed       String?             @map("template_used") @db.VarChar(100)
  requestDate        DateTime?           @map("request_date") @db.Timestamp(6)
  sentDate           DateTime?           @map("sent_date") @db.Timestamp(6)
  responseDate       DateTime?           @map("response_date") @db.Timestamp(6)
  followUpDate       DateTime?           @map("follow_up_date") @db.Timestamp(6)
  nextFollowUpDate   DateTime?           @map("next_follow_up_date") @db.Timestamp(6)
  responseNotes      String?             @map("response_notes")
  outcome            String?             @db.VarChar(255)
  success            Boolean?            @default(false)
  relationshipImpact Int?                @default(0) @map("relationship_impact")
  gratitudeExpressed Boolean?            @default(false) @map("gratitude_expressed")
  gratitudeNotes     String?             @map("gratitude_notes")
  optimalTimingScore Int?                @default(50) @map("optimal_timing_score")
  timingReason       String?             @map("timing_reason") @db.VarChar(255)
  createdAt          DateTime?           @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt          DateTime?           @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  contact            ProfessionalContact @relation(fields: [contactId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  jobOpportunity     JobOpportunity      @relation(fields: [jobId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userProfile        UserProfile         @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([userId], map: "idx_referral_requests_user_id")
  @@index([jobId], map: "idx_referral_requests_job_id")
  @@index([contactId], map: "idx_referral_requests_contact_id")
  @@index([status], map: "idx_referral_requests_status")
  @@index([requestDate], map: "idx_referral_requests_request_date")
  @@index([followUpDate], map: "idx_referral_requests_follow_up_date")
  @@map("referral_requests")
}

enum application_status {
  interested
  applied
  phone_screen
  interview
  offer
  rejected
}

enum referral_status {
  draft
  pending
  sent
  accepted
  declined
  completed
  expired
}

enum team_role {
  owner
  mentor
  coach
  member
  viewer
}

enum team_type {
  career_center
  job_search_group
  mentorship_program
}

enum invitation_status {
  pending
  accepted
  declined
  expired
}

enum task_status {
  pending
  in_progress
  completed
  cancelled
}

enum activity_type {
  team_created
  member_joined
  member_left
  job_shared
  comment_added
  task_assigned
  task_completed
  feedback_given
  milestone_reached
  application_submitted
  interview_scheduled
}

enum task_priority {
  low
  medium
  high
  urgent
}

enum feedback_type {
  resume_review
  cover_letter_review
  interview_prep
  general_guidance
  application_review
}

model Team {
  id               String                 @id @default(dbgenerated("uuid_generate_v4()"))
  name             String                 @db.VarChar(255)
  description      String?
  type             team_type              @default(job_search_group)
  ownerId          String                 @map("owner_id")
  maxMembers       Int?                   @map("max_members")
  isActive         Boolean                @default(true) @map("is_active")
  createdAt        DateTime               @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt        DateTime               @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  owner            UserProfile            @relation("TeamOwner", fields: [ownerId], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  members          TeamMember[]
  invitations      TeamInvitation[]
  sharedJobs       SharedJobOpportunity[]
  tasks            TeamTask[]
  activities       TeamActivity[]
  feedback         TeamFeedback[]

  @@index([ownerId], map: "idx_teams_owner_id")
  @@index([isActive], map: "idx_teams_is_active")
  @@index([type], map: "idx_teams_type")
  @@map("teams")
}

model TeamMember {
  id          String      @id @default(dbgenerated("uuid_generate_v4()"))
  teamId      String      @map("team_id")
  userId      String      @map("user_id")
  role        team_role   @default(member)
  permissions Json?
  joinedAt    DateTime    @default(now()) @map("joined_at") @db.Timestamp(6)
  isActive    Boolean     @default(true) @map("is_active")
  createdAt   DateTime    @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime    @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  team        Team        @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user        UserProfile @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@unique([teamId, userId])
  @@index([teamId], map: "idx_team_members_team_id")
  @@index([userId], map: "idx_team_members_user_id")
  @@index([role], map: "idx_team_members_role")
  @@map("team_members")
}

model TeamInvitation {
  id         String            @id @default(dbgenerated("uuid_generate_v4()"))
  teamId     String            @map("team_id")
  email      String            @db.VarChar(255)
  role       team_role         @default(member)
  invitedBy  String            @map("invited_by")
  token      String            @unique @db.VarChar(255)
  status     invitation_status @default(pending)
  expiresAt  DateTime          @map("expires_at") @db.Timestamp(6)
  acceptedAt DateTime?         @map("accepted_at") @db.Timestamp(6)
  createdAt  DateTime          @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt  DateTime          @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  team       Team              @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  inviter    UserProfile       @relation("InvitationSender", fields: [invitedBy], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([teamId], map: "idx_team_invitations_team_id")
  @@index([email], map: "idx_team_invitations_email")
  @@index([status], map: "idx_team_invitations_status")
  @@index([token], map: "idx_team_invitations_token")
  @@map("team_invitations")
}

model SharedJobOpportunity {
  id         String         @id @default(dbgenerated("uuid_generate_v4()"))
  teamId     String         @map("team_id")
  jobId      String         @map("job_id")
  sharedBy   String         @map("shared_by")
  visibility String         @default("all_members") @db.VarChar(50)
  sharedAt   DateTime       @default(now()) @map("shared_at") @db.Timestamp(6)
  createdAt  DateTime       @default(now()) @map("created_at") @db.Timestamp(6)
  team       Team           @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  job        JobOpportunity @relation(fields: [jobId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  sharer     UserProfile    @relation(fields: [sharedBy], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  comments   JobComment[]

  @@unique([teamId, jobId])
  @@index([teamId], map: "idx_shared_jobs_team_id")
  @@index([jobId], map: "idx_shared_jobs_job_id")
  @@index([sharedBy], map: "idx_shared_jobs_shared_by")
  @@map("shared_job_opportunities")
}

model JobComment {
  id        String               @id @default(dbgenerated("uuid_generate_v4()"))
  shareId   String               @map("share_id")
  userId    String               @map("user_id")
  content   String
  mentions  String[]             @db.VarChar(255)
  createdAt DateTime             @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime             @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  sharedJob SharedJobOpportunity @relation(fields: [shareId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user      UserProfile          @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([shareId], map: "idx_job_comments_share_id")
  @@index([userId], map: "idx_job_comments_user_id")
  @@map("job_comments")
}

model TeamTask {
  id           String         @id @default(dbgenerated("uuid_generate_v4()"))
  teamId       String         @map("team_id")
  assignedTo   String         @map("assigned_to")
  assignedBy   String         @map("assigned_by")
  title        String         @db.VarChar(500)
  description  String?
  dueDate      DateTime?      @map("due_date") @db.Timestamp(6)
  priority     task_priority  @default(medium)
  status       task_status    @default(pending)
  relatedJobId String?        @map("related_job_id")
  completedAt  DateTime?      @map("completed_at") @db.Timestamp(6)
  createdAt    DateTime       @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime       @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  team         Team           @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  assignee     UserProfile    @relation("TaskAssignee", fields: [assignedTo], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  assigner     UserProfile    @relation("TaskCreator", fields: [assignedBy], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  relatedJob   JobOpportunity? @relation(fields: [relatedJobId], references: [id], onDelete: SetNull, onUpdate: NoAction)

  @@index([teamId], map: "idx_team_tasks_team_id")
  @@index([assignedTo], map: "idx_team_tasks_assigned_to")
  @@index([assignedBy], map: "idx_team_tasks_assigned_by")
  @@index([status], map: "idx_team_tasks_status")
  @@index([dueDate], map: "idx_team_tasks_due_date")
  @@map("team_tasks")
}

model TeamActivity {
  id           String        @id @default(dbgenerated("uuid_generate_v4()"))
  teamId       String        @map("team_id")
  userId       String        @map("user_id")
  activityType activity_type @map("activity_type")
  entityType   String?       @map("entity_type") @db.VarChar(50)
  entityId     String?       @map("entity_id")
  metadata     Json?
  createdAt    DateTime      @default(now()) @map("created_at") @db.Timestamp(6)
  team         Team          @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user         UserProfile   @relation(fields: [userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([teamId], map: "idx_team_activities_team_id")
  @@index([userId], map: "idx_team_activities_user_id")
  @@index([activityType], map: "idx_team_activities_type")
  @@index([createdAt], map: "idx_team_activities_created_at")
  @@map("team_activities")
}

model TeamFeedback {
  id                String        @id @default(dbgenerated("uuid_generate_v4()"))
  teamId            String        @map("team_id")
  menteeId          String        @map("mentee_id")
  mentorId          String        @map("mentor_id")
  feedbackType      feedback_type @map("feedback_type")
  content           String
  relatedEntityType String?       @map("related_entity_type") @db.VarChar(50)
  relatedEntityId   String?       @map("related_entity_id")
  createdAt         DateTime      @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt         DateTime      @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  team              Team          @relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  mentee            UserProfile   @relation("FeedbackMentee", fields: [menteeId], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  mentor            UserProfile   @relation("FeedbackMentor", fields: [mentorId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([teamId], map: "idx_team_feedback_team_id")
  @@index([menteeId], map: "idx_team_feedback_mentee_id")
  @@index([mentorId], map: "idx_team_feedback_mentor_id")
  @@index([feedbackType], map: "idx_team_feedback_type")
  @@map("team_feedback")
}
